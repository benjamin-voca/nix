---
apiVersion: postgresql.cnpg.io/v1
kind: Cluster
metadata:
  name: gitea-db
  namespace: gitea
spec:
  instances: 1
  storage:
    size: 10Gi
  bootstrap:
    initdb:
      database: gitea
      owner: gitea
      secret:
        name: gitea-db
---
apiVersion: v1
kind: Secret
metadata:
  name: gitea-db
  namespace: gitea
type: kubernetes.io/basic-auth
stringData:
  username: gitea
  password: ${GITEA_DB_PASSWORD}
---
apiVersion: postgresql.cnpg.io/v1
kind: Cluster
metadata:
  name: infisical-db
  namespace: infisical
spec:
  instances: 1
  storage:
    size: 10Gi
  bootstrap:
    initdb:
      database: infisical
      owner: infisical
      secret:
        name: infisical-db
---
apiVersion: v1
kind: Secret
metadata:
  name: infisical-db
  namespace: infisical
type: kubernetes.io/basic-auth
stringData:
  username: infisical
  password: ${INFISICAL_DB_PASSWORD}
---
apiVersion: v1
kind: Secret
metadata:
  name: infisical-secrets
  namespace: infisical
type: Opaque
stringData:
  ENCRYPTION_KEY: ${INFISICAL_ENCRYPTION_KEY}
  AUTH_SECRET: ${INFISICAL_AUTH_SECRET}
  DB_CONNECTION_URI: "postgresql://infisical:${INFISICAL_DB_PASSWORD}@infisical-db-rw.infisical.svc.cluster.local:5432/infisical"
  REDIS_URL: ""
  SITE_URL: "https://infisical.quadtech.dev"
